# ERPNext Helm Values for kube.vgriz.com
# Dedicated MariaDB + Redis instances, CephFS storage

image:
  repository: frappe/erpnext
  tag: v15.88.1
  pullPolicy: IfNotPresent

nginx:
  replicaCount: 1
  service:
    type: ClusterIP
    port: 8080

worker:
  gunicorn:
    replicaCount: 1
  default:
    replicaCount: 1
  short:
    replicaCount: 1
  long:
    replicaCount: 1
  scheduler:
    replicaCount: 1

socketio:
  replicaCount: 1

# Storage - Using CephFS for RWX support
persistence:
  worker:
    enabled: true
    size: 30Gi
    storageClass: "rook-cephfs"

# MariaDB - Dedicated instance (required for ERPNext)
mariadb:
  enabled: true
  image:
    registry: docker.io
    repository: bitnami/mariadb
    tag: "latest"
  auth:
    rootPassword: "H$1f*@hc0M"
    username: "erpnext"
    password: "H$1f*@hc0M"
    replicationPassword: "H$1f*@hc0M"
  primary:
    service:
      ports:
        mysql: 3306
    persistence:
      enabled: true
      size: 20Gi
      storageClass: "rook-ceph-block"
    extraFlags: >-
      --skip-character-set-client-handshake
      --skip-innodb-read-only-compressed
      --character-set-server=utf8mb4
      --collation-server=utf8mb4_unicode_ci

# Redis Cache - Dedicated instance
redis-cache:
  enabled: true
  image:
    registry: docker.io
    repository: bitnami/redis
    tag: "latest"
  architecture: standalone
  auth:
    enabled: false
    sentinel: false
  master:
    containerPorts:
      redis: 6379
    persistence:
      enabled: false

# Redis Queue - Dedicated instance  
redis-queue:
  enabled: true
  image:
    registry: docker.io
    repository: bitnami/redis
    tag: "latest"
  architecture: standalone
  auth:
    enabled: false
    sentinel: false
  master:
    containerPorts:
      redis: 6379
    persistence:
      enabled: false

# Jobs configuration
jobs:
  configure:
    enabled: true
    fixVolume: true
